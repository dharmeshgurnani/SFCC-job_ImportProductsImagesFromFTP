

# SFCC-job_ImportProductsImagesFromFTP
<p align="center">
    <img alt="visitor"              src="https://visitor-badge.laobi.icu/badge?page_id=dharmeshgurnani.SFCC-job_ImportProductsImagesFromFTP">
    <img alt="release"              src="https://img.shields.io/github/v/release/dharmeshgurnani/SFCC-job_ImportProductsImagesFromFTP?color=green">
    <img alt="commits since"        src="https://img.shields.io/github/commits-since/dharmeshgurnani/SFCC-job_ImportProductsImagesFromFTP/v1.0.0">
    <img alt="last commit"          src="https://img.shields.io/github/last-commit/dharmeshgurnani/SFCC-job_ImportProductsImagesFromFTP">
    <img alt="code size in bytes"   src="https://img.shields.io/github/languages/code-size/dharmeshgurnani/SFCC-job_ImportProductsImagesFromFTP">
    <img alt="downloads"            src="https://img.shields.io/github/downloads/dharmeshgurnani/SFCC-job_ImportProductsImagesFromFTP/total.svg">
</p>

## Introduction
This **Salesforce Commerce Cloud** cartridge provides Job For Importing Product Images from the FTP server, This repository contains a cartridge with Job Step, Job metadata, and Documentation.
## Implementation Documentation

### Pre Requests
**cartradge:**  [SalesforceCommerceCloud/job-components](https://github.com/SalesforceCommerceCloud/job-components) .

### setup
* Clone or Download Cartridges.
* Add Both cartridges to your code version, upload them to the target instance.
* Add cartridge to cartridge paths.
* Import Job from mata folder.
* Go to the Job Schedules tool in BM to verify FtpImportProductImages exist in jobs.
* [Configure](#configuration), run the job.
* Done!

### Configuration
#### job configuration
    downloadImagesFromFTP(custom.CSComponents.FtpUpload)::
      * ServiceID     # FTP/SFTP server endpoint and cridential must be configured in BM.
      * SourceFolder  # location in FTP server.
      * TargetFolder  # to download files to (default: "src/FtpImportProductImages/unassigned").
      * IsDisabled    # this step is disabled by default shoud be enabled to get files form FTP server.

    generateXMLForImageImport(custom.custom.ImportProductImagesJob)::
      * catalogId      # FTP/SFTP server endpoint and cridential must be configured in BM.
      * workingFolder  # working folder for job relative to IMPEX (default: "/src/FtpImportProductImages/").

    importImagesCatalog(ImportCatalog)::
      * workingFolder            # working folder for job relative to IMPEX/src (default: "FtpImportProductImages/xml").
      * ImportMode               # must be set to Merge
      * AfterImportFileHandling  # weather to keep files after import in xml folder of working folder.

#### After configuring job, in the {Working_folder} create this directory structure.
    .
    └──IMPEX
       └──src
          └──working folder # main working folder in IMPEX/src, required by job steps.
              └──unassigned  # contains folders that represent a catalog (data gets downloaded from FTP server using job step 1).
                  ├──catalogId1   # catalog folder name as a valid catalog id contains folders representing products.
                  │   ├──productId1    # product folder contains product Images.
                  │   │   ├──productid1_P_01.jpg
                  │   │   ├──productid1_P_02.jpg
                  │   │   └──productid1_P_03.jpg
                  │   └──productId2
                  │       ├──productid2_P_01.jpg
                  │       ├──productid2_P_02.jpg
                  │       └──productid2_P_03.jpg
                  └──catalogId2
                     ├──productId1
                     │   ├──productid1_P_01.jpg
                     │   ├──productid1_P_02.jpg
                     │   └──productid1_P_03.jpg
                     └──productId2
                         ├──productid2_P_01.jpg
                         ├──productid2_P_02.jpg
                         └──productid2_P_03.jpg


#### Image file name syntex.
* attributes:

    Product ID:  # Product ID of product.


    Image Position:  # Position of image in view type/image group

    values: large,medium,small,thumb


    extention: # image file extention

    values: jpg, png

* syntex:

  {productID}\_P\_{image position}.{extention}
* example:

    productid1_large_P_01.jpg

    productid2_small_P_02.png
## Technical Documentation

### Job Configuration
* context:  Organization
* JobStep 1: custom.CSComponents.FtpUpload from the [job-components](https://github.com/SalesforceCommerceCloud/job-components)
* JobStep 2: custom.custom.ImportProductImagesJob from job_ftp_import_products_images.
* JobStep 3: ImportCatalog Standard import Catalog job step(ImportCatalog).

### Flow
 * JobStep 1: Hendel's Downloads from FTP server.
 * JobStep 2: Hendel's XML generation for catalog image, and moves images files From {WorkingFolder/unassigned} folder to /CATALOG folder.
 * JobStep 2: Hendel's import of catalog XML generated by JobStep2.
